x1 <- c(5.1, 3.5, 2.4, 4.0, 1.7, 2.0, 5.0, 3.2, 5.2, 4.3, 2.9, 1.1, 2.6, 4.0, 5.3,
        4.9, 5.0, 3.9)
x2 <- c(4, 4, 2, 6, 2, 2, 4, 2, 6, 6, 2, 2, 4, 6, 4, 6, 6, 4)
y <- c(2.0, 3.5, 8.5, 4.5, 7.0, 7.0, 2.0, 5.0, 8.0, 5.0, 6.0, 7.5, 4.0, 4.0, 1.0,
       5.0, 6.5, 1.5)
x1x2 <- x1 * x2
model <- lm(y ~ x1 + x2 + x1^2 + x1x2)
plot(t, resid(model), col = "blue", main = "residuals versus time")
library(car)
durbinWatsonTest(model)
hist(resid(model))
rstandard(model)


x1 <- c(28, 28, 32.5, 39, 45.9, 57.8, 58.1, 62.5)
x2 <- c(18, 14, 24, 22, 8, 16, 1, 0)
x3 <- c(10.2, 11.5, 12.1, 9.5, 8.9, 9.2, 8.0, 7.0)
y <- c(12.4, 11.7, 12.4, 10.8, 9.4, 9.5, 8.0, 7.5)
#model <- lm(x1 ~ x2 + x3)
model <- lm(x2 ~ x1 + x3)
#model <- lm(x3 ~ x1 + x2)
summary(model)

x1 <- c(15.57, 44.02, 20.42, 18.74, 49.2, 44.92, 55.48, 59.28, 94.39, 128.02, 96, 131.42, 127.21, 252.9, 409.2, 463.7, 510.22)
x2 <- c(2463, 2048, 3940, 6505, 5723, 11520, 5779, 5969, 8461, 20106, 13313, 10771, 15543, 36194, 34703, 39204, 86533)
x3 <- c(472.92, 1339.75, 620.25, 568.33, 1497.60, 1365.83, 1687.00, 1639.92, 2872.33, 3655.08, 2912.00, 3921.00, 3865.67, 7684.10, 12446.33, 14098.40, 15524.00)
x4 <- c(18, 9.5, 12.8, 36.7, 35.7, 24, 43.3, 46.7, 78.7, 180.5, 60.9, 103.7, 126.8, 157.7, 169.4, 331.4, 371.6)
x5 <- c(4.45, 6.92, 4.28, 3.9, 5.5, 4.6, 5.62, 5.15, 6.18, 6.15, 5.88, 4.88, 5.5, 7, 10.78, 7.05, 6.35)
y <- c(566.52, 696.82, 1033.15, 1603.62, 1611.37, 1613.27, 1854.17,  2160.55, 2305.58, 3503.93, 3571.89, 3741.40, 4026.52, 10343.81, 11732.17, 15414.94, 18854.45)
model <- lm(y ~ x2 + x3 + x5)
model2 <- lm(x2 ~ x3 + x5)
model3 <- lm(x3 ~ x2 + x5)
model5 <- lm(x5 ~ x2 + x3)
#summary(model)
R22 <- summary(model2)$r.squared
R32 <- summary(model3)$r.squared
R52 <- summary(model5)$r.squared
VIF2 <- 1 / (1 - R22)
VIF2
VIF3 <- 1 / (1 - R32)
VIF3
VIF5 <- 1 / (1 - R52)
VIF5

x1 <- c(15.57, 44.02, 20.42, 18.74, 49.2, 44.92, 55.48, 59.28, 94.39, 128.02, 96, 131.42, 127.21, 252.9, 409.2, 463.7, 510.22)
x2 <- c(2463, 2048, 3940, 6505, 5723, 11520, 5779, 5969, 8461, 20106, 13313, 10771, 15543, 36194, 34703, 39204, 86533)
x3 <- c(472.92, 1339.75, 620.25, 568.33, 1497.60, 1365.83, 1687.00, 1639.92, 2872.33, 3655.08, 2912.00, 3921.00, 3865.67, 7684.10, 12446.33, 14098.40, 15524.00)
x4 <- c(18, 9.5, 12.8, 36.7, 35.7, 24, 43.3, 46.7, 78.7, 180.5, 60.9, 103.7, 126.8, 157.7, 169.4, 331.4, 371.6)
x5 <- c(4.45, 6.92, 4.28, 3.9, 5.5, 4.6, 5.62, 5.15, 6.18, 6.15, 5.88, 4.88, 5.5, 7, 10.78, 7.05, 6.35)
y <- c(566.52, 696.82, 1033.15, 1603.62, 1611.37, 1613.27, 1854.17,  2160.55, 2305.58, 3503.93, 3571.89, 3741.40, 4026.52, 10343.81, 11732.17, 15414.94, 18854.45)
model <- lm(y ~ x1 + x2 + x3 + x4 + x5)
model1 <- lm(x1 ~ x2 + x3 + x4 + x5)
model2 <- lm(x2 ~ x1 + x3 + x4 + x5)
model3 <- lm(x3 ~ x1 + x2 + x4 + x5)
model4 <- lm(x4 ~ x1 + x2 + x3 + x5)
model5 <- lm(x5 ~ x1 + x2 + x3 + x4)
R12 <- summary(model1)$r.squared
R22 <- summary(model2)$r.squared
R32 <- summary(model3)$r.squared
R42 <- summary(model4)$r.squared
VIF1 <- 1 / (1 - R12)
VIF2 <- 1 / (1 - R22)
VIF3 <- 1 / (1 - R32)
VIF4 <- 1 / (1 - R42)
VIF5 <- 1 / (1 - R52)
VIF1
VIF2
VIF3
VIF4
VIF5

y <- c(22, 19, 24, 28, 18, 21, 29, 15, 12, 14, 18, 19, 15, 22, 13, 16, 8, 6, 7, 17)
x1 <- c(4900, 5800, 5000, 4400, 3850, 5300, 4100, 4700, 5600, 4900, 3700, 3800, 2400, 1800, 3100,
        2300, 4400, 3300, 2900, 2400)
x2 <- c(9, 10, 11, 12, 13, 15, 20, 22, 24, 27, 28, 31, 36, 37, 40, 41, 42, 42, 45, 46)
x3 <- c(40, 50, 55, 30, 42, 20, 25, 60, 45, 82, 56, 38, 35, 28, 43, 20, 46, 15, 30, 16)
x4 <- c(18, 20, 17, 19, 10, 22, 8, 15, 16, 14, 12, 8, 6, 4, 6, 5, 7, 4, 9, 3)
x5 <- c(1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0)
a_entry <- 0.15
a_stay <- 0.15
m1 <- lm(y ~ x1)
m2 <- lm(y ~ x2)
m3 <- lm(y ~ x3)
m4 <- lm(y ~ x4)
m5 <- lm(y ~ x5)
summary(m1)$coefficients[, 4]
summary(m2)$coefficients[, 4]
summary(m3)$coefficients[, 4]
summary(m4)$coefficients[, 4]
summary(m5)$coefficients[, 4]
m21 <- lm(y ~ x2 + x1)
m23 <- lm(y ~ x2 + x3)
m24 <- lm(y ~ x2 + x4)
m25 <- lm(y ~ x2 + x5)
summary(m21)$coefficients[, 4]
summary(m23)$coefficients[, 4]
summary(m24)$coefficients[, 4]
summary(m25)$coefficients[, 4]
m213 <- lm(y ~ x2 + x1 + x3)
m214 <- lm(y ~ x2 + x1 + x4)
m215 <- lm(y ~ x2 + x1 + x5)
summary(m213)$coefficients[, 4]
summary(m214)$coefficients[, 4]
summary(m215)$coefficients[, 4]

library("olsrr")
full <- lm(y ~ x1 + x2 + x3 + x4 + x5)
summary(full)
ols_step_backward_p(lm(y ~ x1 + x2 + x3 + x4 + x5, data.frame(x1, x2, x3, x4, x5)), prem = 0.15, details = TRUE)

